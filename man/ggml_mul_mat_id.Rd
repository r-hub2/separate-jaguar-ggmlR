% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/operations.R
\name{ggml_mul_mat_id}
\alias{ggml_mul_mat_id}
\title{Matrix Multiplication with Expert Selection (Graph)}
\usage{
ggml_mul_mat_id(ctx, as, b, ids)
}
\arguments{
\item{ctx}{GGML context}

\item{as}{Stacked expert weight matrices [n_embd, n_ff, n_experts]}

\item{b}{Input tensor}

\item{ids}{Expert selection indices tensor (I32)}
}
\value{
Output tensor after expert-selected matrix multiplication
}
\description{
Indirect matrix multiplication for Mixture of Experts architectures.
Selects expert weights based on indices and performs batched matmul.
}
\examples{
\dontrun{
ctx <- ggml_init(64 * 1024 * 1024)
# 8 experts, each with 768x3072 weights
experts <- ggml_new_tensor_3d(ctx, GGML_TYPE_F32, 768, 3072, 8)
input <- ggml_new_tensor_2d(ctx, GGML_TYPE_F32, 768, 32)
# Select 2 experts per token
ids <- ggml_new_tensor_2d(ctx, GGML_TYPE_I32, 2, 32)
output <- ggml_mul_mat_id(ctx, experts, input, ids)
ggml_free(ctx)
}
}
